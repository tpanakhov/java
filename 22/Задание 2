public class RPNCalculatorTestManual {
    
    private static class TestCase {
        String name;
        String expression;
        Double expectedResult;
        Class<? extends Exception> expectedException;
        String expectedErrorMessage;
        
        TestCase(String name, String expression, Double expectedResult) {
            this.name = name;
            this.expression = expression;
            this.expectedResult = expectedResult;
            this.expectedException = null;
        }
        
        TestCase(String name, String expression, Class<? extends Exception> expectedException, String expectedErrorMessage) {
            this.name = name;
            this.expression = expression;
            this.expectedResult = null;
            this.expectedException = expectedException;
            this.expectedErrorMessage = expectedErrorMessage;
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== ТЕСТИРОВАНИЕ RPN КАЛЬКУЛЯТОРА ===\n");
        
        TestCase[] testCases = {
            // Корректные вычисления
            new TestCase("Сложение", "2 3 +", 5.0),
            new TestCase("Вычитание", "5 3 -", 2.0),
            new TestCase("Умножение", "4 3 *", 12.0),
            new TestCase("Деление", "10 2 /", 5.0),
            new TestCase("Сложное выражение 1", "5 1 2 + 4 * + 3 -", 14.0),
            new TestCase("Сложное выражение 2", "2 3 * 4 5 * +", 26.0),
            new TestCase("Дробные числа", "1.5 2.5 +", 4.0),
            new TestCase("Отрицательные числа", "-2 3 *", -6.0),
            
            // Ошибочные случаи
            new TestCase("Деление на ноль", "5 0 /", ArithmeticException.class, "На ноль делить нельзя"),
            new TestCase("Недостаточно операндов (1)", "1 +", RuntimeException.class, "Не хватает чисел"),
            new TestCase("Недостаточно операндов (2)", "1 2 + *", RuntimeException.class, "Не хватает чисел"),
            new TestCase("Некорректное выражение", "1 2 3 +", RuntimeException.class, "Неправильное выражение"),
            new TestCase("Пустое выражение", "", RuntimeException.class, "Неправильное выражение"),
            new TestCase("Недопустимый символ", "1 2 $", RuntimeException.class, "Непонятный символ"),
            new TestCase("Только пробелы", "   ", RuntimeException.class, "Неправильное выражение"),
            new TestCase("Много пробелов", "  2   3   +  ", 5.0),
        };
        
        int passed = 0;
        int failed = 0;
        
        for (TestCase test : testCases) {
            System.out.print("Тест: " + test.name + " ... ");
            
            try {
                double result = RPNCalculator.calculate(test.expression);
                
                if (test.expectedResult != null) {
                    if (Math.abs(result - test.expectedResult) < 0.001) {
                        System.out.println(" ПРОШЕЛ (результат: " + result + ")");
                        passed++;
                    } else {
                        System.out.println(" НЕ ПРОШЕЛ");
                        System.out.println("  Ожидалось: " + test.expectedResult);
                        System.out.println("  Получено: " + result);
                        failed++;
                    }
                } else {
                    System.out.println(" НЕ ПРОШЕЛ");
                    System.out.println("  Ожидалось исключение: " + test.expectedException.getSimpleName());
                    System.out.println("  Получен результат: " + result);
                    failed++;
                }
                
            } catch (Exception e) {
                if (test.expectedException != null && test.expectedException.isInstance(e)) {
                    if (test.expectedErrorMessage == null || e.getMessage().contains(test.expectedErrorMessage)) {
                        System.out.println(" ПРОШЕЛ (ожидаемое исключение: " + e.getClass().getSimpleName() + ")");
                        passed++;
                    } else {
                        System.out.println(" НЕ ПРОШЕЛ");
                        System.out.println("  Ожидалось сообщение: " + test.expectedErrorMessage);
                        System.out.println("  Получено: " + e.getMessage());
                        failed++;
                    }
                } else {
                    System.out.println("✗ НЕ ПРОШЕЛ");
                    System.out.println("  Неожиданное исключение: " + e.getClass().getSimpleName());
                    System.out.println("  Сообщение: " + e.getMessage());
                    failed++;
                }
            }
        }
        
        System.out.println("\n=== РЕЗУЛЬТАТЫ ===");
        System.out.println("Всего тестов: " + (passed + failed));
        System.out.println("Пройдено: " + passed);
        System.out.println("Не пройдено: " + failed);
        System.out.println("Успешность: " + (passed * 100 / (passed + failed)) + "%");
        
        if (failed == 0) {
            System.out.println("\n ВСЕ ТЕСТЫ ПРОЙДЕНЫ УСПЕШНО!");
            System.out.println("Калькулятор защищен от дурака и корректно обрабатывает все случаи.");
        } else {
            System.out.println("\n НЕКОТОРЫЕ ТЕСТЫ НЕ ПРОЙДЕНЫ");
            System.out.println("Требуется доработка калькулятора.");
        }
    }
}
